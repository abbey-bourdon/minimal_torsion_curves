//This gives some basic definitions.

R3:=IntegerRing(3);                                                                                                                                                            
GL3:=GeneralLinearGroup(2,R3);
R9:=IntegerRing(9);
GL9:=GeneralLinearGroup(2,R9);
R27:=IntegerRing(27);
GL27:=GeneralLinearGroup(2,R27);
Borel9:=sub<GL9|[1,1,0,1],[2,0,0,1],[1,0,0,2]>; //This is the Borel subgroup in GL9.
Borel27:=sub<GL27|[1,1,0,1],[2,0,0,1],[1,0,0,2],[11,0,0,1]>; //This is the Borel subgroup in GL27.


//Proof of part (3):

H9:=sub<GL9|[2,2,3,5],[5,4,3,1]>; // This defines the subgroup 9.12.0.2.
Index3Sub:=Subgroups(H9: IndexEqual:=3); // 5 conjugacy classes of subgroups
goodsubs := <>;

for j in [1..#Index3Sub] do
  curK := Index3Sub[j]`subgroup;
  ClassK:=Class(GL9,curK);
  L := SetToIndexedSet(ClassK);
for i in [1..#L] do
  curH := L[i];
  if #(curH meet Borel9) eq #curH then
       	      Append(~goodsubs,curH);
        end if;
end for;
end for;

//This returns 3 subgroups. For each subgroup H, there exists a basis of E_0[9] such that over a cubic field, the image of the mod 9 Galois representation is H. Note that the generators show that there exists a cubic field such that E attains a 9 isogeny and an independent 3 isogeny (since the matrices are upper triangular and diagonal mod 3).


//Proof of part (4):


H27:=sub<GL27|[11,10,9,22],[20,2,9,2]>; //This defines the subgroup 27.36.0.1
Index3Sub:=Subgroups(H27: IndexEqual:=3); // 5 conjugacy classes of subgroups

goodsubs := <>;

for j in [1..#Index3Sub] do
  curK := Index3Sub[j]`subgroup;
  ClassK:=Class(GL27,curK);
  L := SetToIndexedSet(ClassK);
for i in [1..#L] do
  curH := L[i];
  if #(curH meet Borel27) eq #curH then
       	      Append(~goodsubs,curH);
        end if;
end for;
end for;

//This returns 3 subgroups. For each subgroup H, there exists a basis of E_0[27] such that over a cubic field, the image of the mod 27 Galois representation is H. Note that a look at the generators shows that there exists a cubic field such that E attains a 27 isogeny and an independent 3 isogeny.

//Proof of part (7):


H9:=sub<GL9|[4,1,3,5],[5,4,3,7]>; // This defines the subgroup 9.36.0.7.
Index3Sub:=Subgroups(H9: IndexEqual:=3); 
goodsubs := <>;

for j in [1..#Index3Sub] do
  curK := Index3Sub[j]`subgroup;
  ClassK:=Class(GL9,curK);
  L := SetToIndexedSet(ClassK);
for i in [1..#L] do
  curH := L[i];
  if #(curH meet Borel9) eq #curH then
       	      Append(~goodsubs,curH);
        end if;
end for;
end for;

//This returns 3 subgroups. For each subgroup H, there exists a basis of E_0[9] such that over a cubic field, the image of the mod 9 Galois representation is H. Note that the generators show that there exists a cubic field such that E attains a 9 isogeny and an independent 3 isogeny. Moreover, the image of the 9-isogeny character lands in {1, -1}, which means that a twist of E_0 over this field has a rational point of order 9.

//Proof of part (8):


H9:=sub<GL9|[2,7,6,2],[8,2,6,1],[8,5,6,1]>; // This defines the subgroup 9.36.0.8.
Index3Sub:=Subgroups(H9: IndexEqual:=3); 
goodsubs := <>;

for j in [1..#Index3Sub] do
  curK := Index3Sub[j]`subgroup;
  ClassK:=Class(GL9,curK);
  L := SetToIndexedSet(ClassK);
for i in [1..#L] do
  curH := L[i];
  if #(curH meet Borel9) eq #curH then
       	      Append(~goodsubs,curH);
        end if;
end for;
end for;

//This returns 3 subgroups. For each subgroup H, there exists a basis of E_0[9] such that over a cubic field, the image of the mod 9 Galois representation is H. Note that the generators show that there exists a cubic field such that E attains a 9 isogeny and an independent 3 isogeny. 